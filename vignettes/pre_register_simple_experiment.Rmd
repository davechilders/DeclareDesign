---
title: "How to Pre-Register a Simple Experimental Design using the registration package"
author: "Experiments in Governance and Politics"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{How to Pre-Register a Simple Experimental Design using the registration package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

This vignette demonstrates how to pre-register a simple experimental design using the registration package. 

```{r, echo = FALSE}
library(registration)
library(xtable)
set.seed(5)
```

# Defining the experiment

First, we define the sample frame from which we will draw a sample to run the experiment from. This includes defining the levels of analysis and the covariates at each level.

```{r, echo = FALSE}
sample_frame <- declare_sample_frame(
  income = declare_variable(),
  N = 500)
```

Second, we define the potential outcomes, which will be simulated based on the baseline covariate data.

```{r}
potential_outcomes     <-  declare_potential_outcomes(
  condition_names = c("Z0","Z1"),
  outcome_formula = Y ~ .01 + 0*Z0 + .2*Z1 + .1*income 
)
```

Fourth, we define one or more analyses we will run based on simulated data. This analysis will also be used for power analysis.

```{r}
analysis      <- declare_analysis(formula = Y ~ Z + income, treatment_variable = "Z",
                                  method = "lm")
```

Then we declare the design of the experiment, in this case a simple one without clusters or blocking.

```{r}
design <- declare_design(potential_outcomes = potential_outcomes)
```

# Pre-registering the experiment

Finally, we use the pre_register function to create the pre-registration document.

```{r, eval = FALSE}
pre <- pre_register(design = design, sample_frame = sample_frame, 
                    potential_outcomes = potential_outcomes, analysis = analysis, 
                    title = "Lady Tasting Tea", 
                    author = c("Ronald A. Fisher"), 
                    abstract = "Description of the lady tasting tea experiment")
```

```{r, echo = FALSE}
pre <- pre_register(design = design, sample_frame = sample_frame, 
                    potential_outcomes = potential_outcomes, analysis = analysis, 
                    title = "Lady Tasting Tea", 
                    author = c("Ronald A. Fisher"), 
                    abstract = "Description of the lady tasting tea experiment", 
                    make_output = FALSE, temp_dir = TRUE)
```

# Writing a paper based on the experiment

```{r}
##draft_paper_from_pre_registration(pre, data = mock, make_output = FALSE, temp_dir = TRUE)
```
